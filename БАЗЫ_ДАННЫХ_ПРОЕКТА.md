# üóÑÔ∏è –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ CRM –ø—Ä–æ–µ–∫—Ç–µ

## –û–±–∑–æ—Ä

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–≥–∏–±—Ä–∏–¥–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
- **Supabase (PostgreSQL)** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **LocalStorage** - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## 1Ô∏è‚É£ Supabase (PostgreSQL) - –û—Å–Ω–æ–≤–Ω–∞—è –ë–î

### üìç –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:
```
URL: https://pfxzckysajoeuafisfym.supabase.co
Project ID: pfxzckysajoeuafisfym
```

### üîê –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env.local):
```env
VITE_SUPABASE_URL=https://pfxzckysajoeuafisfym.supabase.co
VITE_SUPABASE_PUBLISHABLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
VITE_SUPABASE_PROJECT_ID=pfxzckysajoeuafisfym
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü Supabase

### 1. **auth.users** (–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ Supabase Auth)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

**–ü–æ–ª—è:**
- `id` - UUID (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á)
- `email` - TEXT (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `encrypted_password` - TEXT (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å)
- `email_confirmed_at` - TIMESTAMPTZ
- `user_metadata` - JSONB (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: role, full_name)
- `created_at` - TIMESTAMPTZ
- `updated_at` - TIMESTAMPTZ

**–¢–µ–∫—É—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
- Email: `admin@crm.ru`
- –ü–∞—Ä–æ–ª—å: `admin123`
- User ID: `b2caac36-a0d4-4366-94ac-61904f648f06`

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Supabase
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Å–µ—Å—Å–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

---

### 2. **public.tenders** ‚úÖ –°–û–ó–î–ê–ù–ê

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–Ω–¥–µ—Ä–∞—Ö

**–ü–æ–ª—è:**
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|-----|----------|--------------|
| `id` | UUID | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ |
| `user_id` | UUID | –°–≤—è–∑—å —Å auth.users | ‚úÖ |
| `title` | TEXT | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–Ω–¥–µ—Ä–∞ | ‚úÖ |
| `link` | TEXT | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ–Ω–¥–µ—Ä | ‚ùå |
| `status` | tender_status | –°—Ç–∞—Ç—É—Å (enum) | ‚úÖ |
| `publish_date` | DATE | –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ | ‚úÖ |
| `deadline` | DATE | –î–µ–¥–ª–∞–π–Ω –ø–æ–¥–∞—á–∏ | ‚ùå |
| `submission_date` | DATE | –î–∞—Ç–∞ –ø–æ–¥–∞—á–∏ –∑–∞—è–≤–∫–∏ | ‚ùå |
| `amount` | NUMERIC(15,2) | –ù–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ | ‚ùå |
| `win_amount` | NUMERIC(15,2) | –¶–µ–Ω–∞ –ø–æ–±–µ–¥—ã | ‚ùå |
| `contract_guarantee_percent` | NUMERIC(5,2) | % –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è | ‚ùå |
| `contract_guarantee_amount` | NUMERIC(15,2) | –°—É–º–º–∞ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è | ‚ùå |
| `review_date` | DATE | –î–∞—Ç–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è | ‚ùå |
| `completion_deadline` | DATE | –°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | ‚ùå |
| `comment` | TEXT | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π | ‚ùå |
| `is_archived` | BOOLEAN | –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω | ‚úÖ (default: false) |
| `archived_at` | TIMESTAMPTZ | –î–∞—Ç–∞ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ | ‚ùå |
| `created_at` | TIMESTAMPTZ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ (auto) |
| `updated_at` | TIMESTAMPTZ | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚úÖ (auto) |

**Enum: tender_status**
```sql
CREATE TYPE tender_status AS ENUM (
  'accepting',      -- –ù–æ–≤—ã–π
  'submitted',      -- –ü–æ–¥–∞–Ω–æ
  'review',         -- –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ
  'won',            -- –ü–æ–±–µ–¥–∞
  'in_progress',    -- –í —Ä–∞–±–æ—Ç–µ
  'completed',      -- –ó–∞–≤–µ—Ä—à—ë–Ω - –û–ø–ª–∞—á–µ–Ω
  'lost'            -- –ü—Ä–æ–∏–≥—Ä–∞–Ω
);
```

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_tenders_user_id` - –Ω–∞ user_id
- `idx_tenders_status` - –Ω–∞ status
- `idx_tenders_deadline` - –Ω–∞ deadline

**RLS (Row Level Security):**
```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Ç–µ–Ω–¥–µ—Ä—ã
POLICY "Users can view their own tenders"
  ON tenders FOR SELECT
  USING (auth.uid() = user_id);

-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Ç–µ–Ω–¥–µ—Ä—ã
POLICY "Users can insert their own tenders"
  ON tenders FOR INSERT
  WITH CHECK (auth.uid() = user_id);

-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–≤–æ–∏ —Ç–µ–Ω–¥–µ—Ä—ã
POLICY "Users can update their own tenders"
  ON tenders FOR UPDATE
  USING (auth.uid() = user_id);

-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å —Å–≤–æ–∏ —Ç–µ–Ω–¥–µ—Ä—ã
POLICY "Users can delete their own tenders"
  ON tenders FOR DELETE
  USING (auth.uid() = user_id);
```

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
```sql
-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at
CREATE TRIGGER update_tenders_updated_at
  BEFORE UPDATE ON tenders
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();
```

---

### 3. **public.suppliers** ‚ö†Ô∏è –ù–ï –°–û–ó–î–ê–ù–ê (–º–∏–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞—Ö

**–ü–æ–ª—è:**
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|-----|----------|--------------|
| `id` | UUID | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ |
| `user_id` | UUID | –°–≤—è–∑—å —Å auth.users | ‚úÖ |
| `name` | TEXT | –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ | ‚úÖ |
| `contact_person` | TEXT | –ö–æ–Ω—Ç–∞–∫—Ç–Ω–æ–µ –ª–∏—Ü–æ | ‚ùå |
| `phone` | TEXT | –¢–µ–ª–µ—Ñ–æ–Ω | ‚ùå |
| `email` | TEXT | Email | ‚ùå |
| `address` | TEXT | –ê–¥—Ä–µ—Å | ‚ùå |
| `inn` | TEXT | –ò–ù–ù | ‚ùå |
| `notes` | TEXT | –ó–∞–º–µ—Ç–∫–∏ | ‚ùå |
| `created_at` | TIMESTAMPTZ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ (auto) |
| `updated_at` | TIMESTAMPTZ | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | ‚úÖ (auto) |

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_suppliers_user_id` - –Ω–∞ user_id
- `idx_suppliers_name` - –Ω–∞ name

**RLS:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ tenders (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ)

**–ú–∏–≥—Ä–∞—Ü–∏—è:** `supabase/migrations/20251016071000_create_suppliers_expenses_tables.sql`

---

### 4. **public.expenses** ‚ö†Ô∏è –ù–ï –°–û–ó–î–ê–ù–ê (–º–∏–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø–æ —Ç–µ–Ω–¥–µ—Ä–∞–º

**–ü–æ–ª—è:**
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|------|-----|----------|--------------|
| `id` | UUID | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | ‚úÖ |
| `tender_id` | UUID | –°–≤—è–∑—å —Å tenders | ‚úÖ |
| `amount` | NUMERIC(15,2) | –°—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–∞ | ‚úÖ |
| `description` | TEXT | –û–ø–∏—Å–∞–Ω–∏–µ | ‚ùå |
| `category` | TEXT | –ö–∞—Ç–µ–≥–æ—Ä–∏—è | ‚ùå |
| `date` | DATE | –î–∞—Ç–∞ —Ä–∞—Å—Ö–æ–¥–∞ | ‚úÖ |
| `created_at` | TIMESTAMPTZ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | ‚úÖ (auto) |

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_expenses_tender_id` - –Ω–∞ tender_id
- `idx_expenses_date` - –Ω–∞ date

**RLS:** –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —Å–≤—è–∑—å —Å tenders (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ä–∞—Å—Ö–æ–¥—ã —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö —Ç–µ–Ω–¥–µ—Ä–æ–≤)

**–°–≤—è–∑–∏:**
```sql
FOREIGN KEY (tender_id) REFERENCES tenders(id) ON DELETE CASCADE
```

**–ú–∏–≥—Ä–∞—Ü–∏—è:** `supabase/migrations/20251016071000_create_suppliers_expenses_tables.sql`

---

## 2Ô∏è‚É£ LocalStorage - –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

### üìç –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:
```
Browser LocalStorage
Key prefix: –Ω–µ—Ç (–ø—Ä—è–º—ã–µ –∫–ª—é—á–∏)
```

### üóÇÔ∏è –•—Ä–∞–Ω–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ:

#### 1. **reminders** (–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface Reminder {
  id: string;
  tender_id: string;
  type: 'submission' | 'review' | 'other';
  reminder_date: string;
  description: string;
  is_completed: boolean;
  created_at: string;
  user_id?: string;
}
```

**–ö–ª—é—á:** `reminders`
**–§–æ—Ä–º–∞—Ç:** JSON –º–∞—Å—Å–∏–≤

**–ü–æ—á–µ–º—É LocalStorage:**
- –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- TODO: –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –≤ Supabase

---

#### 2. **companyInfo** (–†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface CompanyInfo {
  name: string;
  inn: string;
  kpp?: string;
  ogrn?: string;
  bankName?: string;
  bik?: string;
  checkingAccount?: string;
  correspondentAccount?: string;
  directorName?: string;
  phone?: string;
  email?: string;
  address?: string;
}
```

**–ö–ª—é—á:** `companyInfo`
**–§–æ—Ä–º–∞—Ç:** JSON –æ–±—ä–µ–∫—Ç

**–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
```javascript
{
  name: '–ú–æ—è –∫–æ–º–ø–∞–Ω–∏—è',
  inn: '',
  kpp: '',
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ
}
```

**–ü–æ—á–µ–º—É LocalStorage:**
- –†–µ–¥–∫–æ –∏–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã –¥–ª—è –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- TODO: –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –≤ Supabase

---

#### 3. **downloadableFiles** (–§–∞–π–ª—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
interface DownloadableFile {
  id: string;
  name: string;
  description: string;
  url: string;
  fileType: string;
  uploadDate: string;
  isDefault?: boolean;
}
```

**–ö–ª—é—á:** `downloadableFiles`
**–§–æ—Ä–º–∞—Ç:** JSON –º–∞—Å—Å–∏–≤

**–ü–æ—á–µ–º—É LocalStorage:**
- –°—Å—ã–ª–∫–∏ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–π–ª—ã
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∞–º–∏—Ö —Ñ–∞–π–ª–æ–≤
- TODO: –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –≤ Supabase Storage

---

#### 4. **Supabase Auth Session**

**–ö–ª—é—á–∏:**
- `sb-pfxzckysajoeuafisfym-auth-token`
- `sb-pfxzckysajoeuafisfym-auth-token-code-verifier`

**–£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ Supabase SDK

**–°–æ–¥–µ—Ä–∂–∏—Ç:**
- JWT access token
- Refresh token
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏

---

## üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–æ–≤ (–†—É—Å—Å–∫–∏–π ‚Üî –ê–Ω–≥–ª–∏–π—Å–∫–∏–π)

**–§–∞–π–ª:** `src/lib/converters.ts`

```typescript
// –†—É—Å—Å–∫–∏–π ‚Üí –ê–Ω–≥–ª–∏–π—Å–∫–∏–π (–¥–ª—è –ë–î)
const statusToDb = {
  '–ù–æ–≤—ã–π': 'accepting',
  '–ü–æ–¥–∞–Ω–æ': 'submitted',
  '–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ': 'review',
  '–ü–æ–±–µ–¥–∞': 'won',
  '–í —Ä–∞–±–æ—Ç–µ': 'in_progress',
  '–ó–∞–≤–µ—Ä—à—ë–Ω - –û–ø–ª–∞—á–µ–Ω': 'completed',
  '–ü—Ä–æ–∏–≥—Ä–∞–Ω': 'lost',
};

// –ê–Ω–≥–ª–∏–π—Å–∫–∏–π ‚Üí –†—É—Å—Å–∫–∏–π (–¥–ª—è UI)
const statusFromDb = {
  'accepting': '–ù–æ–≤—ã–π',
  'submitted': '–ü–æ–¥–∞–Ω–æ',
  'review': '–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ',
  'won': '–ü–æ–±–µ–¥–∞',
  'in_progress': '–í —Ä–∞–±–æ—Ç–µ',
  'completed': '–ó–∞–≤–µ—Ä—à—ë–Ω - –û–ø–ª–∞—á–µ–Ω',
  'lost': '–ü—Ä–æ–∏–≥—Ä–∞–Ω',
};
```

### –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã

**tenderFromDb()** - –∏–∑ –ë–î –≤ UI —Ñ–æ—Ä–º–∞—Ç
**tenderToDb()** - –∏–∑ UI –≤ –ë–î —Ñ–æ—Ä–º–∞—Ç

**–ü—Ä–∏–º–µ—Ä:**
```typescript
// –ë–î ‚Üí UI
const uiTender = tenderFromDb(dbTender);
// title, link, status: '–ù–æ–≤—ã–π'

// UI ‚Üí –ë–î
const dbTender = tenderToDb(uiTender);
// title, link, status: 'accepting'
```

---

## üìÅ –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

```
supabase/migrations/
‚îú‚îÄ‚îÄ 20251004175945_*.sql          # –ù–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
‚îú‚îÄ‚îÄ 20251005071605_*.sql          # –°–æ–∑–¥–∞–Ω–∏–µ tenders
‚îú‚îÄ‚îÄ 20251005085954_*.sql          # RLS –¥–ª—è tenders
‚îú‚îÄ‚îÄ 20251005092452_*.sql          # –ò–Ω–¥–µ–∫—Å—ã
‚îú‚îÄ‚îÄ 20251005194700_*.sql          # –¢—Ä–∏–≥–≥–µ—Ä—ã
‚îú‚îÄ‚îÄ ... (–µ—â–µ 10 –º–∏–≥—Ä–∞—Ü–∏–π)
‚îú‚îÄ‚îÄ 20251016070000_create_admin_user.sql           # –°–æ–∑–¥–∞–Ω–∏–µ admin@crm.ru
‚îî‚îÄ‚îÄ 20251016071000_create_suppliers_expenses_tables.sql  # Suppliers + Expenses
```

### –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:

**–ß–µ—Ä–µ–∑ SQL Editor:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://supabase.com/dashboard/project/pfxzckysajoeuafisfym/sql
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ SQL —Ñ–∞–π–ª–∞
3. –í—Å—Ç–∞–≤—å—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "Run"

**–ß–µ—Ä–µ–∑ CLI:**
```bash
supabase db push
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Row Level Security (RLS)

**–í–∫–ª—é—á–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü:**
- ‚úÖ tenders
- ‚úÖ suppliers (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏)
- ‚úÖ expenses (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏)

**–ü—Ä–∏–Ω—Ü–∏–ø:**
```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
WHERE auth.uid() = user_id
```

### –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞:

1. **SELECT** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏
2. **INSERT** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç —Å–≤–æ–µ–≥–æ –∏–º–µ–Ω–∏
3. **UPDATE** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏
4. **DELETE** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
- **auth.users** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **tenders** - —Ç–µ–Ω–¥–µ—Ä—ã
- **LocalStorage** - reminders, companyInfo, downloadableFiles

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è:
- **suppliers** - –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏
- **expenses** - —Ä–∞—Å—Ö–æ–¥—ã

### üìù TODO (–±—É–¥—É—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã):
- **reminders** - –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏–∑ LocalStorage –≤ Supabase
- **company_info** - –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∏–∑ LocalStorage –≤ Supabase
- **files** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase Storage
- **notifications** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **activity_log** - –ª–æ–≥ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏

### DataContext (src/context/DataContext.tsx)

**–§—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
loadTenders()      // ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
loadSuppliers()    // ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
loadExpenses()     // ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞)
loadCompanyInfo()  // ‚úÖ –ò–∑ LocalStorage
loadDownloadableFiles() // ‚úÖ –ò–∑ LocalStorage
```

**–§—É–Ω–∫—Ü–∏–∏ CRUD:**
```typescript
// Tenders
addTender()
updateTender()
deleteTender()

// Suppliers (–ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã)
addSupplier()
updateSupplier()
deleteSupplier()

// Expenses (–ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã)
addExpense()
updateExpense()
deleteExpense()
```

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:
- **Supabase:** ~15 –º–∏–≥—Ä–∞—Ü–∏–π, 1 —Ç–∞–±–ª–∏—Ü–∞ (tenders)
- **LocalStorage:** 3 –∫–ª—é—á–∞ (reminders, companyInfo, downloadableFiles)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **Supabase:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- **LocalStorage:** –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ ~5-10MB

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

1. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:**
   ```bash
   # –°–æ–∑–¥–∞–π—Ç–µ suppliers –∏ expenses
   –í—ã–ø–æ–ª–Ω–∏—Ç–µ: supabase/migrations/20251016071000_create_suppliers_expenses_tables.sql
   ```

2. **–ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ LocalStorage –≤ Supabase:**
   - –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã reminders, company_info
   - –ú–∏–≥—Ä–∏—Ä—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Supabase Storage:**
   - –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å downloadableFiles

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Supabase Dashboard:** https://supabase.com/dashboard/project/pfxzckysajoeuafisfym
- **SQL Editor:** https://supabase.com/dashboard/project/pfxzckysajoeuafisfym/sql
- **Table Editor:** https://supabase.com/dashboard/project/pfxzckysajoeuafisfym/editor
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Supabase:** https://supabase.com/docs

---

## ‚úÖ –ò—Ç–æ–≥–æ

**–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- üü¢ Supabase (PostgreSQL) - –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üü° LocalStorage - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- üîê RLS –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö
- üìä 15+ –º–∏–≥—Ä–∞—Ü–∏–π –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î

**–°—Ç–∞—Ç—É—Å:**
- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –¢–µ–Ω–¥–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚ö†Ô∏è –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ –∏ —Ä–∞—Å—Ö–æ–¥—ã —Ç—Ä–µ–±—É—é—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
- üìù –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è LocalStorage ‚Üí Supabase
