# Изменения в логике работы со статусами тендеров

## Обновленные статусы

1. **"Новый"** (ранее "Приём заявок")
   - Начальный статус при создании тендера
   - Указывается только начальная цена
   - Можно указать дедлайн подачи заявки
   - Автоматически создается напоминание с дедлайном
   - Все поля доступны для редактирования

2. **"Подано"**
   - При смене статуса открывается модальное окно с полями:
     - Дата подачи заявки (автозаполнение текущей датой)
     - Моя цена подачи (обязательное поле)
   - После сохранения:
     - Начальная цена блокируется (disabled, серый фон, иконка замка)
     - Моя цена подачи блокируется
     - Напоминание автоматически удаляется

3. **"Рассмотрение"**
   - Все цены заблокированы
   - Доступен переход только на "Победа" или "Проигран"

4. **"Победа"** → автоматически переходит в **"В работе"**
   - Тендер автоматически добавляется в раздел "Бухгалтерия"
   - Моя цена подачи используется как цена для расчетов
   - Можно добавлять расходы

5. **"Проигран"**
   - При смене статуса открывается модалка:
     - Цена победителя (необязательное поле)
   - Финальный статус
   - НЕ попадает в бухгалтерию

6. **"Завершён - Оплачен"** (ранее "Завершён")
   - Финальный статус для выигранных тендеров
   - Тендер остается в бухгалтерии навсегда
   - Доступен через фильтр "Завершённые"

## Изменения в структуре данных (types/index.ts)

```typescript
export interface Tender {
  id: string;
  name: string;
  url: string;
  status: TenderStatus;
  publicationDate: string;
  submissionDeadline?: string; // Дедлайн подачи заявки
  submissionDate?: string; // Фактическая дата подачи
  initialPrice: number; // Начальная цена (блокируется после "Подано")
  mySubmissionPrice?: number; // Моя цена подачи
  winnerPrice?: number; // Цена победителя (для "Проигран")
  contractSecurityPercent: number;
}
```

## Блокировка полей

- После статуса "Подано": начальная цена и моя цена подачи = readonly
- Визуальная индикация:
  - Серый фон (`bg-gray-100`)
  - Иконка замка (`Lock` icon)
  - Cursor: not-allowed

## Бухгалтерия

- Тендеры попадают ТОЛЬКО при статусе "В работе" или "Завершён - Оплачен"
- Добавлен фильтр:
  - "Все" - все тендеры в бухгалтерии
  - "В работе" - только активные
  - "Завершённые" - только завершённые
- Для расчетов используется `mySubmissionPrice` вместо `winPrice`

## Напоминания

- Автоматически создаются для тендеров в статусе "Новый" (если указан дедлайн)
- Автоматически удаляются при смене статуса на "Подано"
- При создании напоминания вручную доступны только тендеры со статусом "Новый"

## Цвета статусов

- "Новый" - синий (`bg-blue-100 text-blue-800`)
- "Подано" - желтый (`bg-yellow-100 text-yellow-800`)
- "Рассмотрение" - оранжевый (`bg-orange-100 text-orange-800`)
- "Победа" - зеленый (`bg-green-100 text-green-800`)
- "В работе" - фиолетовый (`bg-purple-100 text-purple-800`)
- "Завершён - Оплачен" - темно-зеленый (`bg-emerald-100 text-emerald-800`)
- "Проигран" - красный (`bg-red-100 text-red-800`)

## Переходы между статусами

- Новый → Подано
- Подано → Рассмотрение
- Рассмотрение → Победа | Проигран
- Победа → В работе (автоматически)
- В работе → Завершён - Оплачен
- Проигран - финальный статус
- Завершён - Оплачен - финальный статус

## Измененные файлы

1. `src/types/index.ts` - обновлена структура Tender и TenderStatus
2. `src/pages/TendersPage.tsx` - полностью переписан с новой логикой
3. `src/context/DataContext.tsx` - добавлена автоматическая логика управления напоминаниями
4. `src/pages/AccountingPage.tsx` - добавлен фильтр, обновлена логика отображения
5. `src/pages/RemindersPage.tsx` - фильтрация доступных тендеров
