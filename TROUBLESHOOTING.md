# Устранение неполадок CRM

## Проблема: Белый экран при запуске

### Причины и решения:

1. **Неправильная конфигурация роутинга**
   - ✅ **Исправлено**: Настроена динамическая конфигурация basename в зависимости от окружения
   - Локально: `basename=""` 
   - Продакшн: `basename="/CRM"`

2. **Неправильная конфигурация Vite**
   - ✅ **Исправлено**: Настроена динамическая конфигурация base в `vite.config.ts`
   - Разработка: `base: "/"`
   - Сборка: `base: "/CRM/"`

3. **Отсутствие типов для Vite**
   - ✅ **Исправлено**: Создан файл `src/vite-env.d.ts` с типами

## Различия между Lovable и локальной разработкой

### Lovable (онлайн IDE)
- Автоматически настроен для GitHub Pages
- Использует `base: "/CRM/"` и `basename="/CRM"`
- Работает в контексте поддомена

### Локальная разработка
- Запускается на `localhost:5173`
- Использует `base: "/"` и `basename=""`
- Работает в корне домена

## Команды для запуска

### Локальная разработка
```bash
# Быстрый запуск (macOS/Linux)
./dev-start.sh

# Или вручную
npm install
npm run dev
```

### Деплой на GitHub Pages
```bash
npm run build
npm run deploy
```

## Проверка работоспособности

1. **Локально**: Откройте http://localhost:5173
2. **GitHub Pages**: Откройте https://yourusername.github.io/CRM

### Ожидаемое поведение:
- Страница входа загружается без белого экрана
- Форма авторизации отображается корректно
- После входа (admin@crm.ru / admin123) открывается дашборд

## Дополнительные проблемы

### Ошибки TypeScript в IDE
- Это нормально до установки зависимостей
- Запустите `npm install` для устранения

### Проблемы с портом
- По умолчанию используется порт 5173
- Если занят, Vite автоматически выберет другой

### Очистка кэша браузера
```bash
# Очистить localStorage (если нужно)
# Откройте DevTools -> Application -> Local Storage -> Clear All
```

## Структура конфигурации

```typescript
// vite.config.ts
export default defineConfig(({ command }) => ({
  base: command === 'build' ? '/CRM/' : '/',
  // ...
}))

// App.tsx
const basename = import.meta.env.PROD ? '/CRM' : '';
<BrowserRouter basename={basename}>
```

Эта конфигурация обеспечивает корректную работу как в локальной разработке, так и на GitHub Pages.
